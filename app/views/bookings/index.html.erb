<div class="banner">
  <h1>FarmBNB</h1>
  <p>- My Booking Details -</p>
</div>

<div class="line">
  <hr>
</div>

<div class="container my-5">
  <div class="row justify-content-center">

    <div class="col-md-6">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h3 class="bookings-greeting"><%= current_user.first_name.capitalize %>'s bookings</h3>
          <p><%= pluralize(current_user.bookings.count, "booking") %></p>
        </div>
          <div class="card-body">
          <% @bookings.each do |booking| %>

            <div class="d-flex justify-content-between align-items-center pe-3">
              <%= link_to animal_path(booking.animal), class: "text-decoration-none" do  %>
              <h2 class="card-title text-danger"><%= booking.animal.name %></h2>
              <% end %>


              <%= link_to edit_booking_path(booking, animal:booking.animal), class: 'text-danger text-decoration-none' do %>
              <p><i class="fa-solid fa-pen-to-square"></i> Edit your booking</p>
              <% end %>
            </div>
            <div class="d-flex justify-content-between align-items-center pe-3">
              <p>From <%= booking.start_date %> to <%= booking.end_date %></p>
              <%= link_to booking_path(booking), class: "text-danger text-decoration-none",
                  data: {turbo_method: :delete, turbo_confirm: "Cancel booking for '#{booking.animal.name}'?"} do %>
                  <p><i class="fa-regular fa-trash-can"></i> Cancel booking</p>
              <% end %>
            </div>
            <hr>
          <% end %>
        </div>
      </div>
    </div>

<%# ======================================================== %>

<div class="col-md-6">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h3>Bookings for <%= current_user.first_name.capitalize %>'s animals</h3>
      <p><%= pluralize(current_user.animals.map { |animal| animal.bookings.count }.sum, "booking") %></p>
    </div>
    <div class="card-body">
      <% current_user.animals.each do |animal| %>
        <% animal.bookings.each do |booking| %>
          <div class="d-flex justify-content-between align-items-center pe-3">
              <%= link_to animal_path(booking.animal), class: "text-decoration-none" do  %>
              <h2 class="card-title text-danger"><%= booking.animal.name %></h2>
              <% end %>
              <p>Booked by: <%= booking.user.first_name.capitalize %> <%= booking.user.last_name.capitalize %> </p>
          </div>
          <p>From <%= booking.start_date %> to <%= booking.end_date %></p>
          <hr>
        <% end %>
      <% end %>
    </div>
  </div>
</div>


  </div>
</div>
